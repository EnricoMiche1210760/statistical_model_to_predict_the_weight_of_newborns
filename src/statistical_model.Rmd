---
title: "Statistical Model To Predict The Weight Of Newborns"
author: "Enrico Michelon"
output:
    pdf_document: default
---

```{r setup, include=FALSE}
library(dplyr)
library(ggplot2)
```
## Introduction
This project concerns the creation of a statistical model to predict the weight of newborns. Our objective is to create a
statistical model given the *neonati.csv* dataset that can be extended to the entire population.<br>
```{r dataframe_table, results='asis', echo=FALSE}
newborns_dataset <- read.csv("data/neonati.csv")
knitr::kable(head(newborns_dataset), type = "latex", align='c', booktabs = TRUE, , 
    caption = "Dataset first rows")
```

## Dataset
The dataset is composed by 2500 samples and, studying its first rows, we can distinguish 10 variables: Anni.madre, N.gravidanze, Fumatrici, Gestazione, 
Peso, Lunghezza, Cranio, Tipo.parto, Ospedale and Sesso. 

### Anni.madre
Anni.madre is a quantitative variable on radio scale. In the dataset we have at least two outlayers, 
which can be found at rows 1152 and 1380, and report an age of 1 and 0, respectively. 
Computing position measures and standard deviation excluding those rows, we obtain:
<div align="center">

```{r anni_madre_summary, results='asis', echo=FALSE}
min_val <- min(newborns_dataset$Anni.madre)
line <- which(newborns_dataset$Anni.madre == min_val)
anni_madre_without_outlayers <- newborns_dataset$Anni.madre[
    -c(line, which(newborns_dataset$Anni.madre == 1))]

sigma.anni_madre <- round(sd(anni_madre_without_outlayers), 2)

df_sigma <- data.frame(std.dev = sigma.anni_madre)

knitr::kable(t(c(round(summary(anni_madre_without_outlayers), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Anni.madre")
```

</div>

### N.gravidanze
N.gravidanze is a quantitative variable on ratio scale. In Table 3 position measures
and standard deviation for the variable are shown.<br>
We can see that mean and standard deviation and third interquartile are around 1 
(0.98, 1.28 and 1 respectively), while the maximum reaches a value of 12.
<div align="center">

```{r n_gravidanze_summary, results='asis', echo=FALSE}

sigma.n_gravidanze <- round(sd(newborns_dataset$N.gravidanze), 2)

df_sigma <- data.frame(std.dev = sigma.n_gravidanze)

knitr::kable(t(c(round(summary(newborns_dataset$N.gravidanze), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Anni.madre")
```

</div>

We can look now at the distribution of *N.gravidanze*. From the graphic we can notice that 
it is a normal positive skewed distribution, with mean 0.98 and standard deviation of 1.28.
<div align="center">

```{r n_gravidanze_density, results='asis', echo=FALSE}

ggplot(data = newborns_dataset, 
        aes(x = N.gravidanze)) +
  geom_bar(color = 'blue', fill = 'lightblue') +
  labs(title = 'Continuous Density Plot') +
  scale_x_continuous(breaks = seq(0, 13, 1)) +
  theme_minimal()
```

</div>

### Fumatrici
Fumatrici is a qualitative encoded variable on nominal scale, with values 0 and 1. 
Value 0 means that the mother is not a smoker, while mothers with "Fumatrici" value of
1 means she is a smoker. In Table 4 we can observe measures of position and standard deviation.
<div align="center">

```{r fumatrici_summary, results='asis', echo=FALSE}

sigma.fumatrici <- round(sd(newborns_dataset$Fumatrici), 2)

df_sigma <- data.frame(std.dev = sigma.fumatrici)   

knitr::kable(t(c(round(summary(newborns_dataset$Fumatrici), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Fumatrici")
```
</div>

Media of 0.04, means that the 96% of the mothers are not smokers. We can also observe it from
the next figure.
```{r fumatrici_graphic, results='asis', echo=FALSE}

ggplot(data = newborns_dataset, 
        aes(y = Fumatrici)) +
  geom_bar(color = 'blue', fill = 'lightblue', width = 0.35,
           position = "identity") +
  labs(title = 'Continuous Density Plot') +
  scale_y_continuous(breaks = seq(0, 1, 1)) +
  theme_minimal()
```
</div>

### Gestazione
Gestazione is a quantitative variable on ratio scale, measured in weeks, 
with position and standard deviation measures that can be seen in Table 5. <br>
As we expect, the mean value is around 40 weeks (38.98), with a low standard deviation 
of 1.87 weeks.

<div align="center">

```{r gestazione_summary, results='asis', echo=FALSE}

sigma.gestazione <- round(sd(newborns_dataset$Gestazione), 2)

df_sigma <- data.frame(std.dev = sigma.gestazione)   

knitr::kable(t(c(round(summary(newborns_dataset$Gestazione), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Gestazione")
```
</div>


### Peso
Peso is a quantitative variable on ratio scale, and represents the weight of 
newborns in grams. Position measures and standard deviation are observable in Table 6. 

<div align="center">

```{r peso_summary, results='asis', echo=FALSE}

sigma.Peso <- round(sd(newborns_dataset$Peso), 2)

df_sigma <- data.frame(std.dev = sigma.Peso)   

knitr::kable(t(c(round(summary(newborns_dataset$Peso), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Peso")
iqr <- IQR(newborns_dataset$Peso)

```
</div>

It is interesting to note that "Peso" has in IQR value of 630 grams, while the range is 
of 4100. This can been explained studying the graphic on Figure 3.
The distribution is a Normal distribution, negatively skewed, with very long tails,
specially on the left, making a large different between IQR (represented by red line 
on the graphic) and range.

<div align="center">

```{r peso_density, results='asis', echo=FALSE}

plot(density(newborns_dataset$Peso), col = "blue", , main = "Peso distribution")
Q1 <- quantile(newborns_dataset$Peso, .25)
Q3 <- quantile(newborns_dataset$Peso, .75)
abline(v=Q1, col = "red")
abline(v=Q3, col = "red")
skew <- moments::skewness(newborns_dataset$Peso)




```
</div>

### Lunghezza
Lunghezza is a quantitative variable on ratio scale. Represents the length of the newborn in millimeters.
For this variable we expect a behaviour quite similar to variable "Peso". 

<div align="center">

```{r Lunghezza_summary, results='asis', echo=FALSE}

sigma.Lunghezza <- round(sd(newborns_dataset$Lunghezza), 2)

df_sigma <- data.frame(std.dev = sigma.Lunghezza)   

knitr::kable(t(c(round(summary(newborns_dataset$Lunghezza), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Lunghezza")
```
</div>

<div align="center">
```{r Lunghezza_density, results='asis', echo=FALSE}
layout(matrix(c(1, 2), ncol = 2)) 
plot(density(newborns_dataset$Lunghezza), col = "blue", main = "Lunghezza distribution")
Q1 <- quantile(newborns_dataset$Lunghezza, .25)
Q3 <- quantile(newborns_dataset$Lunghezza, .75)
abline(v=Q1, col = "red")
abline(v=Q3, col = "red")
skew <- moments::skewness(newborns_dataset$Lunghezza)

plot(density(newborns_dataset$Peso), col = "blue", main = "Peso distribution")
Q1 <- quantile(newborns_dataset$Peso, .25)
Q3 <- quantile(newborns_dataset$Peso, .75)
abline(v=Q1, col = "red")
abline(v=Q3, col = "red")

```
</div>

### Cranio
Cranio is a quantitative variable on ratio scale. Represents the cranium diameter 
of the newborn in millimeters. <br>
In Table ***, we can observe position measures and standard deviation for variable "Cranio". 

<div align="center">

```{r cranio_summary, results='asis', echo=FALSE}

sigma.Cranio <- round(sd(newborns_dataset$Cranio), 2)

df_sigma <- data.frame(std.dev = sigma.Cranio)   

knitr::kable(t(c(round(summary(newborns_dataset$Cranio), 2), df_sigma)),
    type="html", align='c', 
    caption = "Position measures and standard deviation for Cranio")
```

</div>

### Tipo.parto
Tipo.parto is a qualitative variable on nominal scale. Represents the type of childbirth, and is encoded with 
"Nat" (natural) and "Ces" (caesarean). For a qualitative variable we can compute Gini index, which provides
a measure of heterogeneity.

<div align="center">
```{r tipo_parto_gini, include=FALSE}
sigma.Cranio <- gini.index(newborns_dataset$Tipo.parto)
```

</div>



### Ospedale
Ospedale is a qualitative variable on nominal scale. It represents three different hospitals, and is coded in "osp 1", 
"osp 2" and "osp 3". The index of Gini is ******* which means that the variable is *******.

<div align="center">
```{r tipo_parto_gini, include=FALSE}
sigma.Cranio <- gini.index(newborns_dataset$Ospedale)
```

</div>

### Sesso
Sesso is a qualitative variable on nominal scale. Represents the sex of the newborn, and is coded with "M" for males 
and "F" for females. The index of Gini is ******* which means that the variable is *******.
In Figure ****** we can see the distribution of "Sesso".

<div align="center">
```{r tipo_parto_gini, include=FALSE}
sigma.Cranio <- gini.index(newborns_dataset$Sesso)
```

</div>


